<html lang="zh-CN"><head>

<script class="injected-ffc2e83d85">
(function(){'use strict';function q(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}}function t(b){var c=typeof Symbol!="undefined"&&Symbol.iterator&&b[Symbol.iterator];if(c)return c.call(b);if(typeof b.length=="number")return{next:q(b)};throw Error(String(b)+" is not an iterable or ArrayLike");}var u=typeof Object.defineProperties=="function"?Object.defineProperty:function(b,c,g){if(b==Array.prototype||b==Object.prototype)return b;b[c]=g.value;return b};
function v(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<b.length;++c){var g=b[c];if(g&&g.Math==Math)return g}throw Error("Cannot find global object");}var w=v(this);function x(b,c){if(c)a:{var g=w;b=b.split(".");for(var h=0;h<b.length-1;h++){var l=b[h];if(!(l in g))break a;g=g[l]}b=b[b.length-1];h=g[b];c=c(h);c!=h&&c!=null&&u(g,b,{configurable:!0,writable:!0,value:c})}}
function y(){this.j=!1;this.g=null;this.u=void 0;this.h=1;this.v=this.l=0;this.i=null}function z(b){if(b.j)throw new TypeError("Generator is already running");b.j=!0}y.prototype.o=function(b){this.u=b};function A(b,c){b.i={I:c,J:!0};b.h=b.l||b.v}y.prototype.return=function(b){this.i={return:b};this.h=this.v};function B(b){this.g=new y;this.h=b}function E(b,c){z(b.g);var g=b.g.g;if(g)return F(b,"return"in g?g["return"]:function(h){return{value:h,done:!0}},c,b.g.return);b.g.return(c);return G(b)}
function F(b,c,g,h){try{var l=c.call(b.g.g,g);if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");if(!l.done)return b.g.j=!1,l;var m=l.value}catch(f){return b.g.g=null,A(b.g,f),G(b)}b.g.g=null;h.call(b.g,m);return G(b)}function G(b){for(;b.g.h;)try{var c=b.h(b.g);if(c)return b.g.j=!1,{value:c.value,done:!1}}catch(g){b.g.u=void 0,A(b.g,g)}b.g.j=!1;if(b.g.i){c=b.g.i;b.g.i=null;if(c.J)throw c.I;return{value:c.return,done:!0}}return{value:void 0,done:!0}}
function H(b){this.next=function(c){z(b.g);b.g.g?c=F(b,b.g.g.next,c,b.g.o):(b.g.o(c),c=G(b));return c};this.throw=function(c){z(b.g);b.g.g?c=F(b,b.g.g["throw"],c,b.g.o):(A(b.g,c),c=G(b));return c};this.return=function(c){return E(b,c)};this[Symbol.iterator]=function(){return this}}function I(b){function c(h){return b.next(h)}function g(h){return b.throw(h)}return new Promise(function(h,l){function m(f){f.done?h(f.value):Promise.resolve(f.value).then(c,g).then(m,l)}m(b.next())})}
x("Symbol",function(b){function c(m){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new g(h+(m||"")+"_"+l++,m)}function g(m,f){this.g=m;u(this,"description",{configurable:!0,writable:!0,value:f})}if(b)return b;g.prototype.toString=function(){return this.g};var h="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",l=0;return c});
x("Symbol.iterator",function(b){if(b)return b;b=Symbol("Symbol.iterator");u(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return J(q(this))}});return b});function J(b){b={next:b};b[Symbol.iterator]=function(){return this};return b}
x("Promise",function(b){function c(f){this.h=0;this.i=void 0;this.g=[];this.u=!1;var a=this.j();try{f(a.resolve,a.reject)}catch(d){a.reject(d)}}function g(){this.g=null}function h(f){return f instanceof c?f:new c(function(a){a(f)})}if(b)return b;g.prototype.h=function(f){if(this.g==null){this.g=[];var a=this;this.i(function(){a.l()})}this.g.push(f)};var l=w.setTimeout;g.prototype.i=function(f){l(f,0)};g.prototype.l=function(){for(;this.g&&this.g.length;){var f=this.g;this.g=[];for(var a=0;a<f.length;++a){var d=
f[a];f[a]=null;try{d()}catch(e){this.j(e)}}}this.g=null};g.prototype.j=function(f){this.i(function(){throw f;})};c.prototype.j=function(){function f(e){return function(k){d||(d=!0,e.call(a,k))}}var a=this,d=!1;return{resolve:f(this.D),reject:f(this.l)}};c.prototype.D=function(f){if(f===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.G(f);else{a:switch(typeof f){case "object":var a=f!=null;break a;case "function":a=!0;break a;default:a=!1}a?this.C(f):this.o(f)}};
c.prototype.C=function(f){var a=void 0;try{a=f.then}catch(d){this.l(d);return}typeof a=="function"?this.H(a,f):this.o(f)};c.prototype.l=function(f){this.v(2,f)};c.prototype.o=function(f){this.v(1,f)};c.prototype.v=function(f,a){if(this.h!=0)throw Error("Cannot settle("+f+", "+a+"): Promise already settled in state"+this.h);this.h=f;this.i=a;this.h===2&&this.F();this.K()};c.prototype.F=function(){var f=this;l(function(){if(f.B()){var a=w.console;typeof a!=="undefined"&&a.error(f.i)}},1)};c.prototype.B=
function(){if(this.u)return!1;var f=w.CustomEvent,a=w.Event,d=w.dispatchEvent;if(typeof d==="undefined")return!0;typeof f==="function"?f=new f("unhandledrejection",{cancelable:!0}):typeof a==="function"?f=new a("unhandledrejection",{cancelable:!0}):(f=w.document.createEvent("CustomEvent"),f.initCustomEvent("unhandledrejection",!1,!0,f));f.promise=this;f.reason=this.i;return d(f)};c.prototype.K=function(){if(this.g!=null){for(var f=0;f<this.g.length;++f)m.h(this.g[f]);this.g=null}};var m=new g;c.prototype.G=
function(f){var a=this.j();f.A(a.resolve,a.reject)};c.prototype.H=function(f,a){var d=this.j();try{f.call(a,d.resolve,d.reject)}catch(e){d.reject(e)}};c.prototype.then=function(f,a){function d(n,r){return typeof n=="function"?function(C){try{e(n(C))}catch(D){k(D)}}:r}var e,k,p=new c(function(n,r){e=n;k=r});this.A(d(f,e),d(a,k));return p};c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.A=function(f,a){function d(){switch(e.h){case 1:f(e.i);break;case 2:a(e.i);break;default:throw Error("Unexpected state: "+
e.h);}}var e=this;this.g==null?m.h(d):this.g.push(d);this.u=!0};c.resolve=h;c.reject=function(f){return new c(function(a,d){d(f)})};c.race=function(f){return new c(function(a,d){for(var e=t(f),k=e.next();!k.done;k=e.next())h(k.value).A(a,d)})};c.all=function(f){var a=t(f),d=a.next();return d.done?h([]):new c(function(e,k){function p(C){return function(D){n[C]=D;r--;r==0&&e(n)}}var n=[],r=0;do n.push(void 0),r++,h(d.value).A(p(n.length-1),k),d=a.next();while(!d.done)})};return c});
function K(b,c){return Object.prototype.hasOwnProperty.call(b,c)}x("Object.is",function(b){return b?b:function(c,g){return c===g?c!==0||1/c===1/g:c!==c&&g!==g}});x("Array.prototype.includes",function(b){return b?b:function(c,g){var h=this;h instanceof String&&(h=String(h));var l=h.length;g=g||0;for(g<0&&(g=Math.max(g+l,0));g<l;g++){var m=h[g];if(m===c||Object.is(m,c))return!0}return!1}});
x("String.prototype.includes",function(b){return b?b:function(c,g){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,g||0)!==-1}});
x("WeakMap",function(b){function c(d){this.g=(a+=Math.random()+1).toString();if(d){d=t(d);for(var e;!(e=d.next()).done;)e=e.value,this.set(e[0],e[1])}}function g(){}function h(d){var e=typeof d;return e==="object"&&d!==null||e==="function"}function l(d){if(!K(d,f)){var e=new g;u(d,f,{value:e})}}function m(d){var e=Object[d];e&&(Object[d]=function(k){if(k instanceof g)return k;Object.isExtensible(k)&&l(k);return e(k)})}if(function(){if(!b||!Object.seal)return!1;try{var d=Object.seal({}),e=Object.seal({}),
k=new b([[d,2],[e,3]]);if(k.get(d)!=2||k.get(e)!=3)return!1;k.delete(d);k.set(e,4);return!k.has(d)&&k.get(e)==4}catch(p){return!1}}())return b;var f="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var a=0;c.prototype.set=function(d,e){if(!h(d))throw Error("Invalid WeakMap key");l(d);if(!K(d,f))throw Error("WeakMap key fail: "+d);d[f][this.g]=e;return this};c.prototype.get=function(d){return h(d)&&K(d,f)?d[f][this.g]:void 0};c.prototype.has=function(d){return h(d)&&K(d,
f)&&K(d[f],this.g)};c.prototype.delete=function(d){return h(d)&&K(d,f)&&K(d[f],this.g)?delete d[f][this.g]:!1};return c});
x("Map",function(b){function c(){var a={};return a.m=a.next=a.head=a}function g(a,d){var e=a[1];return J(function(){if(e){for(;e.head!=a[1];)e=e.m;for(;e.next!=e.head;)return e=e.next,{done:!1,value:d(e)};e=null}return{done:!0,value:void 0}})}function h(a,d){var e=d&&typeof d;e=="object"||e=="function"?m.has(d)?e=m.get(d):(e=""+ ++f,m.set(d,e)):e="p_"+d;var k=a[0][e];if(k&&K(a[0],e))for(a=0;a<k.length;a++){var p=k[a];if(d!==d&&p.key!==p.key||d===p.key)return{id:e,list:k,index:a,entry:p}}return{id:e,
list:k,index:-1,entry:void 0}}function l(a){this[0]={};this[1]=c();this.size=0;if(a){a=t(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||typeof b!="function"||!b.prototype.entries||typeof Object.seal!="function")return!1;try{var a=Object.seal({x:4}),d=new b(t([[a,"s"]]));if(d.get(a)!="s"||d.size!=1||d.get({x:4})||d.set({x:4},"t")!=d||d.size!=2)return!1;var e=d.entries(),k=e.next();if(k.done||k.value[0]!=a||k.value[1]!="s")return!1;k=e.next();return k.done||k.value[0].x!=
4||k.value[1]!="t"||!e.next().done?!1:!0}catch(p){return!1}}())return b;var m=new WeakMap;l.prototype.set=function(a,d){a=a===0?0:a;var e=h(this,a);e.list||(e.list=this[0][e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this[1],m:this[1].m,head:this[1],key:a,value:d},e.list.push(e.entry),this[1].m.next=e.entry,this[1].m=e.entry,this.size++);return this};l.prototype.delete=function(a){a=h(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this[0][a.id],a.entry.m.next=a.entry.next,
a.entry.next.m=a.entry.m,a.entry.head=null,this.size--,!0):!1};l.prototype.clear=function(){this[0]={};this[1]=this[1].m=c();this.size=0};l.prototype.has=function(a){return!!h(this,a).entry};l.prototype.get=function(a){return(a=h(this,a).entry)&&a.value};l.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};l.prototype.keys=function(){return g(this,function(a){return a.key})};l.prototype.values=function(){return g(this,function(a){return a.value})};l.prototype.forEach=
function(a,d){for(var e=this.entries(),k;!(k=e.next()).done;)k=k.value,a.call(d,k[1],k[0],this)};l.prototype[Symbol.iterator]=l.prototype.entries;var f=0;return l});
x("Set",function(b){function c(g){this.g=new Map;if(g){g=t(g);for(var h;!(h=g.next()).done;)this.add(h.value)}this.size=this.g.size}if(function(){if(!b||typeof b!="function"||!b.prototype.entries||typeof Object.seal!="function")return!1;try{var g=Object.seal({x:4}),h=new b(t([g]));if(!h.has(g)||h.size!=1||h.add(g)!=h||h.size!=1||h.add({x:4})!=h||h.size!=2)return!1;var l=h.entries(),m=l.next();if(m.done||m.value[0]!=g||m.value[1]!=g)return!1;m=l.next();return m.done||m.value[0]==g||m.value[0].x!=4||
m.value[1]!=m.value[0]?!1:l.next().done}catch(f){return!1}}())return b;c.prototype.add=function(g){g=g===0?0:g;this.g.set(g,g);this.size=this.g.size;return this};c.prototype.delete=function(g){g=this.g.delete(g);this.size=this.g.size;return g};c.prototype.clear=function(){this.g.clear();this.size=0};c.prototype.has=function(g){return this.g.has(g)};c.prototype.entries=function(){return this.g.entries()};c.prototype.values=function(){return this.g.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=
c.prototype.values;c.prototype.forEach=function(g,h){var l=this;this.g.forEach(function(m){return g.call(h,m,m,l)})};return c});(function(){function b(){return m?Promise.resolve(m):f?f:f=fetch("https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json").then(function(a){if(!a.ok)throw Error("HTTP error! status: "+a.status+" fetching https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json");return a.json()}).then(function(a){if(!Array.isArray(a))throw new TypeError("Fetched icon names from https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json is not an array.");
return m=a}).catch(function(a){console.error("IconChecker: Failed to load valid icon names from https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json.",a);f=null;throw a;})}function c(a){var d,e,k,p;return I(new H(new B(function(n){switch(n.h){case 1:d=(a.textContent||"").trim();if(!d||a.classList.contains("js-replaced-missing-icon")&&d==="radio_button_unchecked")return n.return();e=window.getComputedStyle(a);if(e.display==="none"||e.visibility==="hidden")return n.return();
n.l=2;var r=b();n.h=4;return{value:r};case 4:k=n.u;n.h=3;n.l=0;break;case 2:return n.l=0,n.i=null,console.warn('IconChecker: Skipping check for icon "'+d+'" as valid names could not be loaded.'),n.return();case 3:(p=k.includes(d))?a.classList.contains("js-replaced-missing-icon")&&a.classList.remove("js-replaced-missing-icon"):d==="radio_button_unchecked"&&a.classList.contains("js-replaced-missing-icon")||(a.textContent="radio_button_unchecked",a.classList.add("js-replaced-missing-icon")),n.h=0}})))}
function g(a){a=a===void 0?document.body:a;a.querySelectorAll(l).forEach(function(d){c(d)})}function h(){b().catch(function(){});document.fonts.ready.then(function(){requestAnimationFrame(function(){g(document.body);(new MutationObserver(function(a){var d=new Set;a=t(a);for(var e=a.next();!e.done;e=a.next())if(e=e.value,e.type==="childList")e.addedNodes.forEach(function(p){p.nodeType===Node.ELEMENT_NODE&&(p.matches(l)&&d.add(p),p.querySelectorAll(l).forEach(function(n){d.add(n)}))});else if(e.type===
"attributes"&&e.attributeName==="class"){var k=e.target;e.target.nodeType===Node.ELEMENT_NODE&&k.matches(l)&&d.add(k)}else e.type==="characterData"&&e.target.parentNode&&(e=e.target.parentNode,e.nodeType===Node.ELEMENT_NODE&&e.matches(l)&&d.add(e));d.size>0&&setTimeout(function(){d.forEach(function(p){c(p)})},500)})).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"],characterData:!0})})}).catch(function(a){console.error("IconChecker: Font loading error. Scanning icons anyway.",
a);requestAnimationFrame(function(){g(document.body)})})}var l=["material-icons","material-symbols-outlined","material-symbols-rounded","material-symbols-sharp"].map(function(a){return"."+a}).join(","),m=null,f=null;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){h()}):h()})();}).call(this);

</script>

    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>合记农业·玉米种植智能辅助 Pro v4.5</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Material Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Toastify -->
    <link href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" rel="stylesheet" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js" type="text/javascript"></script>
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; background-color: #f0fdf4; color: #1f2937; }
        .tab-btn { transition: all 0.3s; border-bottom: 3px solid transparent; }
        .tab-active { color: #166534; border-bottom-color: #eab308; background-color: #dcfce7; }
        .tab-inactive:hover { background-color: #f3f4f6; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: #166534; cursor: pointer; margin-top: -6px; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #d1d5db; border-radius: 2px; }
        .npk-input { text-align: center; font-weight: bold; color: #15803d; }
        
        .status-dot {
            height: 8px; width: 8px; background-color: #22c55e; border-radius: 50%; display: inline-block;
            box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
            animation: pulse-green 2s infinite;
        }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 6px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
        .data-stream {
            font-family: monospace; font-size: 10px; color: #4ade80; opacity: 0.8;
            white-space: nowrap; overflow: hidden;
            border-right: 2px solid #4ade80;
            animation: typing 3s steps(40, end), blink-caret .75s step-end infinite;
        }
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink-caret { from, to { border-color: transparent } 50% { border-color: #4ade80; } }
        
        .soil-level-btn.active { background-color: #15803d; color: white; border-color: #15803d; }
        
        .formula-card { transition: all 0.3s ease; }
        .formula-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        .char-circle { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-weight: bold; color: white; margin-right: 12px; flex-shrink: 0; }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1{left:0.25rem}.right-0{right:0px}.top-0{top:0px}.top-2{top:0.5rem}.top-8{top:2rem}.z-10{z-index:10}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-1{margin-left:0.25rem;margin-right:0.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:0.25rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-3{margin-top:0.75rem}.mt-auto{margin-top:auto}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-16{height:4rem}.h-2{height:0.5rem}.h-4{height:1rem}.h-40{height:10rem}.h-full{height:100%}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-12{width:3rem}.w-16{width:4rem}.w-20{width:5rem}.w-4{width:1rem}.w-full{width:100%}.max-w-7xl{max-width:80rem}.flex-1{flex:1 1 0%}.flex-grow{flex-grow:1}.cursor-pointer{cursor:pointer}.appearance-none{-webkit-appearance:none;appearance:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.rounded-xl{border-radius:0.75rem}.rounded-bl{border-bottom-left-radius:0.25rem}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-l-4{border-left-width:4px}.border-t-4{border-top-width:4px}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-300{--tw-border-opacity:1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-100{--tw-border-opacity:1;border-color:rgb(220 252 231 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity:1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity:1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-600{--tw-border-opacity:1;border-color:rgb(22 163 74 / var(--tw-border-opacity, 1))}.border-orange-100{--tw-border-opacity:1;border-color:rgb(255 237 213 / var(--tw-border-opacity, 1))}.border-orange-200{--tw-border-opacity:1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-red-100{--tw-border-opacity:1;border-color:rgb(254 226 226 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity:1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-white\/20{border-color:rgb(255 255 255 / 0.2)}.border-yellow-100{--tw-border-opacity:1;border-color:rgb(254 249 195 / var(--tw-border-opacity, 1))}.border-yellow-200{--tw-border-opacity:1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1))}.border-yellow-500{--tw-border-opacity:1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-cyan-600{--tw-bg-opacity:1;background-color:rgb(8 145 178 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-800{--tw-bg-opacity:1;background-color:rgb(22 101 52 / var(--tw-bg-opacity, 1))}.bg-green-900{--tw-bg-opacity:1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity:1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity:1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:rgb(255 255 255 / 0.1)}.bg-yellow-50{--tw-bg-opacity:1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-yellow-500{--tw-bg-opacity:1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-\[url\(\'https\:\/\/www\.transparenttextures\.com\/patterns\/cubes\.png\'\)\]{background-image:url('https://www.transparenttextures.com/patterns/cubes.png')}.p-1{padding:0.25rem}.p-1\.5{padding:0.375rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.px-1{padding-left:0.25rem;padding-right:0.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pb-2{padding-bottom:0.5rem}.pb-4{padding-bottom:1rem}.pl-4{padding-left:1rem}.pt-1{padding-top:0.25rem}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[12px\]{font-size:12px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-relaxed{line-height:1.625}.tracking-wider{letter-spacing:0.05em}.tracking-widest{letter-spacing:0.1em}.text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity:1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity:1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity:1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity:1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-orange-900{--tw-text-opacity:1;color:rgb(124 45 18 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-400{--tw-text-opacity:1;color:rgb(250 204 21 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity:1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-yellow-800{--tw-text-opacity:1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.underline{-webkit-text-decoration-line:underline;text-decoration-line:underline}.opacity-10{opacity:0.1}.opacity-50{opacity:0.5}.opacity-70{opacity:0.7}.shadow{--tw-shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-500{transition-duration:500ms}.duration-300{transition-duration:300ms}.hover\:border-green-500:hover{--tw-border-opacity:1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.hover\:bg-green-50:hover{--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\:bg-red-50:hover{--tw-bg-opacity:1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\:bg-white\/20:hover{background-color:rgb(255 255 255 / 0.2)}.hover\:bg-yellow-50:hover{--tw-bg-opacity:1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.hover\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.focus\:border-blue-500:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:border-green-500:focus{--tw-border-opacity:1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.focus\:border-orange-500:focus{--tw-border-opacity:1;border-color:rgb(249 115 22 / var(--tw-border-opacity, 1))}.focus\:border-yellow-500:focus{--tw-border-opacity:1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-green-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(34 197 94 / var(--tw-ring-opacity, 1))}.has-\[\:checked\]\:border-green-500:has(:checked){--tw-border-opacity:1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.has-\[\:checked\]\:border-green-600:has(:checked){--tw-border-opacity:1;border-color:rgb(22 163 74 / var(--tw-border-opacity, 1))}.has-\[\:checked\]\:border-red-500:has(:checked){--tw-border-opacity:1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.has-\[\:checked\]\:border-yellow-500:has(:checked){--tw-border-opacity:1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.has-\[\:checked\]\:bg-green-100:has(:checked){--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.has-\[\:checked\]\:bg-green-50:has(:checked){--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.has-\[\:checked\]\:bg-red-100:has(:checked){--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.has-\[\:checked\]\:bg-yellow-100:has(:checked){--tw-bg-opacity:1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:block{display:block}.md\:inline{display:inline}.md\:w-auto{width:auto}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:items-center{align-items:center}.md\:p-6{padding:1.5rem}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:text-xl{font-size:1.25rem;line-height:1.75rem}.md\:text-xs{font-size:0.75rem;line-height:1rem}}@media (min-width: 1024px){.lg\:col-span-5{grid-column:span 5 / span 5}.lg\:col-span-7{grid-column:span 7 / span 7}.lg\:grid-cols-12{grid-template-columns:repeat(12, minmax(0, 1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}</style></head>
<body class="flex flex-col min-h-screen">
<!-- Network Bar -->
<div class="text-green-400 text-[10px] py-2 px-4 flex flex-col md:flex-row justify-between items-center sticky top-0 z-50 transition-colors duration-500 bg-green-900" id="network-bar">
    <div class="flex items-center gap-3 w-full md:w-auto">
        <span class="status-dot"></span>
        <span id="network-msg">系统状态：在线 | 数据库：v4.5</span>
    </div>
    <div class="hidden md:block w-1/3">
        <div class="data-stream" id="data-stream-text">LOADING: Growth Stages... OK | PDF DATA: INTEGRATED</div>
    </div>
    <div class="font-mono opacity-70 flex items-center gap-2">
        <span class="material-symbols-outlined text-[10px]">database</span>
        <span id="db-version">Pro v4.5</span>
    </div>
</div>
<!-- Header -->
<header class="bg-green-800 text-white shadow-lg relative z-40">
    <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <span class="material-symbols-outlined text-yellow-400 text-3xl">agriculture</span>
            <div>
                <h1 class="text-lg md:text-xl font-bold tracking-wider">合记农业·玉米种植智能辅助 <span class="text-xs bg-yellow-600 text-white px-1 rounded ml-1">Pro v4.5</span></h1>
                <p class="text-[10px] text-green-200">全周期植保 · 动态复配 · 成本精算（所有内容只作为参考，不构成任何建议和指导）</p>
            </div>
        </div>
        <button class="flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-xs font-bold border border-white/20 transition" onclick="downloadApp()">
            <span class="material-symbols-outlined text-sm">download</span> 保存
        </button>
    </div>
</header>
<!-- Navigation -->
<nav class="bg-white shadow border-b border-gray-200 sticky top-8 z-30">
    <div class="max-w-7xl mx-auto flex">
        <button class="tab-inactive flex-1 py-3 font-bold text-sm md:text-base flex items-center justify-center gap-2 tab-btn" id="tab-planting" onclick="switchTab('planting')">
            <span class="material-symbols-outlined">grid_on</span> 播种规划
        </button>
        <button class="tab-inactive flex-1 py-3 font-bold text-sm md:text-base flex items-center justify-center gap-2 tab-btn" id="tab-protection" onclick="switchTab('protection')">
            <span class="material-symbols-outlined">pest_control</span> 植保图谱
        </button>
        <button class="tab-active flex-1 py-3 font-bold text-sm md:text-base flex items-center justify-center gap-2 tab-btn" id="tab-fertilizer" onclick="switchTab('fertilizer')">
            <span class="material-symbols-outlined">science</span> 施肥与药剂
        </button>
    </div>
</nav>
<main class="flex-grow max-w-7xl mx-auto w-full p-4 md:p-6 space-y-6">
    <!-- 1. Planting -->
    <section class="space-y-6 hidden" id="view-planting">
        <div class="bg-white rounded-xl shadow overflow-hidden border-t-4 border-yellow-500">
            <div class="p-4 bg-yellow-50 border-b border-yellow-100 flex items-center gap-2">
                <span class="material-symbols-outlined text-yellow-700">stars</span>
                <h2 class="font-bold text-yellow-800 text-lg">整地建议</h2>
            </div>
            <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="formula-card bg-white p-3 rounded-lg border border-gray-100 flex items-start">
                    <div class="char-circle bg-blue-600 text-xl">深</div>
                    <div>
                        <h4 class="font-bold text-gray-800">30厘米深翻</h4>
                        <p class="text-xs text-gray-500 mt-1">强抗旱、抗倒伏。打破犁底层，增加土壤蓄水能力。</p>
                    </div>
                </div>
                <div class="formula-card bg-white p-3 rounded-lg border border-gray-100 flex items-start">
                    <div class="char-circle bg-green-600 text-xl">松</div>
                    <div>
                        <h4 class="font-bold text-gray-800">土壤疏松</h4>
                        <p class="text-xs text-gray-500 mt-1">出苗快，苗壮，扎根深，坐苗牢。利于根系下扎。</p>
                    </div>
                </div>
                <div class="formula-card bg-white p-3 rounded-lg border border-gray-100 flex items-start">
                    <div class="char-circle bg-yellow-600 text-xl">平</div>
                    <div>
                        <h4 class="font-bold text-gray-800">地平如镜</h4>
                        <p class="text-xs text-gray-500 mt-1">保障播种质量，下种均匀一致。防止播种深浅不一。</p>
                    </div>
                </div>
                <div class="formula-card bg-white p-3 rounded-lg border border-gray-100 flex items-start">
                    <div class="char-circle bg-purple-600 text-xl">碎</div>
                    <div>
                        <h4 class="font-bold text-gray-800">土碎如面</h4>
                        <p class="text-xs text-gray-500 mt-1">杜绝压种、压苗现象，苗情一致。增加种子土壤接触。</p>
                    </div>
                </div>
                <div class="formula-card bg-white p-3 rounded-lg border border-gray-100 flex items-start">
                    <div class="char-circle bg-cyan-600 text-xl">墒</div>
                    <div>
                        <h4 class="font-bold text-gray-800">底墒充足</h4>
                        <p class="text-xs text-gray-500 mt-1">墒情好，出苗快，耐旱，齐全匀壮。湿而不粘。</p>
                    </div>
                </div>
                <div class="formula-card bg-gray-50 p-3 rounded-lg border border-gray-200 flex items-center justify-center text-center">
                    <p class="text-sm font-bold text-gray-700 italic">“深翻一铲，土碎如面，地平如镜，湿而不粘”</p>
                </div>
            </div>
        </div>
        <div class="bg-white rounded-xl shadow p-6 border-l-4 border-green-600">
            <h2 class="text-lg font-bold text-green-800 mb-4 flex items-center gap-2">
                <span class="material-symbols-outlined">calculate</span> 播种密度计算器
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">垄型选择</label>
                        <div class="flex gap-4">
                            <label class="flex-1 cursor-pointer border-2 border-green-100 rounded-lg p-3 hover:border-green-500 has-[:checked]:border-green-600 has-[:checked]:bg-green-50 transition">
                                <input checked="" class="hidden" name="ridgeType" onchange="updatePlantingCalc()" type="radio" value="normal">
                                <div class="font-bold text-green-800 text-center">普通垄</div>
                                <div class="text-xs text-gray-500 text-center">常规种植</div>
                            </label>
                            <label class="flex-1 cursor-pointer border-2 border-green-100 rounded-lg p-3 hover:border-green-500 has-[:checked]:border-green-600 has-[:checked]:bg-green-50 transition">
                                <input class="hidden" name="ridgeType" onchange="updatePlantingCalc()" type="radio" value="big">
                                <div class="font-bold text-green-800 text-center">大垄双行</div>
                                <div class="text-xs text-gray-500 text-center">通透高产模式</div>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">平均行距 (cm)</label>
                        <input class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-green-500 outline-none transition" id="ridgeSpace" oninput="updatePlantingCalc()" type="number" value="60">
                        <p class="text-xs text-gray-400 mt-1" id="ridgeHint">输入垄距</p>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">目标保苗 (株/亩)</label>
                        <input class="w-full border border-gray-300 rounded-lg p-2 focus:ring-2 focus:ring-green-500 outline-none transition" id="targetDensity" oninput="updatePlantingCalc()" type="number" value="4500">
                    </div>
                </div>
                <div class="bg-green-900 rounded-xl p-6 text-white flex flex-col justify-center items-center shadow-inner relative overflow-hidden">
                    <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
                    <h3 class="text-green-200 text-sm uppercase font-bold tracking-widest mb-2 z-10">理论株距 (种子间距)</h3>
                    <div class="text-6xl font-mono font-bold z-10" id="plantSpaceResult">24.7</div>
                    <div class="text-xl mt-2 z-10">厘米 (cm)</div>
                </div>
            </div>
        </div>
    </section>
    <!-- 2. Protection -->
    <section class="space-y-6 hidden" id="view-protection">
        <div class="bg-white rounded-xl shadow p-6">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 border-b pb-4 gap-4">
                <div>
                    <h2 class="text-lg font-bold text-green-800 flex items-center gap-2">
                        <span class="material-symbols-outlined">menu_book</span> VE-R4 全周期精准植保图谱
                    </h2>
                    <p class="text-[12px] text-gray-500 mt-1 font-medium">玉米生长发育核心数据 · 逆境预警</p>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-xs font-bold text-gray-500">当前筛选:</span>
                    <select class="border rounded p-1 text-xs" onchange="filterProtection(this.value)">
                        <option value="all">显示全部阶段</option>
                        <option value="seedling">苗期 (VE-V6)</option>
                        <option value="ear">穗期 (V9-VT)</option>
                        <option value="grain">花粒期 (R1-R4)</option>
                    </select>
                </div>
            </div>
            <div class="space-y-6" id="protection-list"><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">spa</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">VE 出苗期 (Emergence)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 地温稳定 &gt;10℃
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 持水量 60-70%
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 查苗补种：缺苗&gt;10%应及时补种或移栽。板结土壤需破除。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">根系建立与全苗关键期。重点防地下害虫、根腐病及杂草。低温(&lt;10℃)或除草剂残留可致'螺旋状中胚轴'，造成出苗失败。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('VE', this.value)">
                                <option value="0">方案A: 常规种衣剂 (基础版)</option><option value="1">方案B: 双效加强版 (推荐)</option><option value="2">方案C: 封闭除草套餐 (播后苗前)</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-VE">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">苯醚甲环唑 + 噻虫嗪</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">成本低，对常见蚜虫、丝黑穗病有效。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">对根腐病及顽固地下害虫持效期较短。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">grass</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">V3-V5 苗期 (Seedling)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 日均 18-22℃
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 适度蹲苗
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 除草剂药害预警：避开高温，避开3叶前5叶后。紫苗通常随气温回升消失。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">除草最佳窗口期。生长点位于地下(V6前)，对轻微霜冻/冰雹有耐受力。如遇低温/缺磷/根系受阻，叶片可能变紫(花青素积累)。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('V3', this.value)">
                                <option value="0">方案A: 标准除草 (安全型)</option><option value="1">方案B: 苗后除草+提苗复配</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-V3">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">烟嘧磺隆·莠去津 + 安全剂</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">杀草谱广，对玉米相对安全。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">对由于环境压力大的弱苗可能有轻微抑制。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">nature</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">V6-V8 拔节期 (Jointing)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 生长旺盛期
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 需水增加
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 追肥提示：结合降雨或灌溉追施氮肥。若遇洪涝，淹水不可超2-4天。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">生长点出土，茎秆快速伸长。节根成为主要根系。此时若地表干旱，易发生'无根/倒伏玉米'综合征(Rootless Corn)。需肥临界期。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('V6', this.value)">
                                <option value="0">方案A: 营养补充型</option><option value="1">方案B: 药肥一体防虫</option><option value="2">方案C: 化学控旺 (防倒伏专用)</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-V6">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">尿素(叶喷) + 磷酸二氢钾 + 螯合锌</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">纠正缺锌花白叶，促进茎秆粗壮。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">单纯营养，无防虫功能。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">local_florist</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">V9-V12 大喇叭口 (Bell Mouth)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 高温高湿
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 需水高峰
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 关键节点：行数已定，主攻粒数。此期受旱减产最严重。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">V9雄穗发育。V12时，种子行数已确定(受遗传主导)。每行粒数开始决定(V12-V17)。此期受旱或叶片损伤将严重影响穗大小。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('V12', this.value)">
                                <option value="0">方案A: 攻穗防虫型</option><option value="1">方案B: 飞防高效包</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-V12">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">辛硫磷颗粒(丢心) + 尿素(根施)</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">传统方法，成本极低，效果直接。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">人工成本高，效率低。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">filter_vintage</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">VT-R1 抽雄吐丝 (Tasseling)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 忌&gt;30-35℃高温
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 必须充足
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 热害预警：防花丝'结球'。虫害阈值：花丝被咬断至&lt;1cm且授粉&lt;50%需防治。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">授粉期。花粉散落高峰在上午9-10点。高温(&gt;30℃)减少散粉。干旱每天减产3-8%。冰雹致叶片脱落可致100%减产。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('VT', this.value)">
                                <option value="0">方案A: 授粉保卫战</option><option value="1">方案B: 一喷多效旗舰版</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-VT">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">流体硼 + 芸苔素内酯 + 磷酸二氢钾</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">提高花粉活力，减少秃尖，抗热干风。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">无杀菌杀虫功能。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div><div class="bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300">
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">grain</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">R2-R4 灌浆乳熟 (Filling)</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> 昼夜温差大好
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> 保持湿润
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ 适时晚收：苞叶变黄后推迟7-10天收获，增产5-10%。
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">籽粒建成期。水泡期(R2)至乳熟期(R3)。若遇连续阴天、干旱 or 氮不足，尖端籽粒易败育(Abortion)。</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" onchange="updateRecipeDetails('R2', this.value)">
                                <option value="0">方案A: 防衰增重</option><option value="1">方案B: 杀菌防病晚收</option>
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-R2">
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">高浓度磷酸二氢钾 (100-200g/亩)</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">促进灌浆，增加千粒重，防止倒伏。</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">功能单一。</span>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div></div>
        </div>
    </section>
    <!-- 3. Fertilizer -->
    <section class="" id="view-fertilizer">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Left Panel -->
            <div class="lg:col-span-5 space-y-4">
                <div class="bg-white rounded-xl shadow p-4 border border-yellow-500 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-yellow-500 text-white text-[10px] px-2 py-0.5 rounded-bl">New Feature</div>
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 pb-2 border-b border-yellow-100">
                        <span class="material-symbols-outlined text-yellow-600">terrain</span> 土壤肥力评估
                    </h3>
                    <div class="flex gap-2 mb-4 bg-gray-100 p-1 rounded-lg">
                        <button class="flex-1 py-1 text-xs font-bold rounded-md transition soil-level-btn active" id="btn-soil-l1" onclick="switchSoilLevel(1)">经验</button>
                        <button class="flex-1 py-1 text-xs font-bold rounded-md transition soil-level-btn" id="btn-soil-l3" onclick="switchSoilLevel(3)">测土</button>
                    </div>
                    <!-- Level 1 (经验) -->
                    <div class="space-y-3" id="soil-level-1">
                        <div>
                            <label class="text-xs font-bold text-gray-600 mb-1 block">土壤质地与颜色</label>
                            <select class="w-full border border-gray-300 rounded p-1.5 text-xs bg-white" id="soilL1Type" onchange="calculateAll()">
                                <option value="high">⚫️ 黑土/黑钙土 (肥沃)</option>
                                <option selected="" value="mid">🟤 褐土/黄壤 (中等)</option>
                                <option value="low">🟡 沙土/白浆土 (贫瘠)</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-600 mb-1 block">常年地力水平</label>
                            <div class="flex gap-2">
                                <label class="flex-1 text-center border p-1 rounded cursor-pointer hover:bg-green-50 has-[:checked]:bg-green-100 has-[:checked]:border-green-500">
                                    <input class="hidden" name="soilL1Yield" onchange="calculateAll()" type="radio" value="high">
                                    <span class="text-xs font-bold text-green-700">高产田</span>
                                </label>
                                <label class="flex-1 text-center border p-1 rounded cursor-pointer hover:bg-yellow-50 has-[:checked]:bg-yellow-100 has-[:checked]:border-yellow-500">
                                    <input checked="" class="hidden" name="soilL1Yield" onchange="calculateAll()" type="radio" value="mid">
                                    <span class="text-xs font-bold text-yellow-700">中产田</span>
                                </label>
                                <label class="flex-1 text-center border p-1 rounded cursor-pointer hover:bg-red-50 has-[:checked]:bg-red-100 has-[:checked]:border-red-500">
                                    <input class="hidden" name="soilL1Yield" onchange="calculateAll()" type="radio" value="low">
                                    <span class="text-xs font-bold text-red-700">低产田</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <!-- Level 3 (测土) -->
                    <div class="space-y-2 hidden" id="soil-level-3">
                        <div class="grid grid-cols-2 gap-2">
                            <div><label class="text-[10px] font-bold text-gray-600">土壤PH值</label><input class="w-full border rounded p-1 text-xs font-bold focus:border-green-500 outline-none" id="soilL3PH" oninput="calculateAll()" step="0.1" type="number" value="6.5"></div>
                            <div><label class="text-[10px] font-bold text-gray-600">全氮含量 (g/kg)</label><input class="w-full border rounded p-1 text-xs font-bold focus:border-green-500 outline-none" id="soilL3TN" oninput="calculateAll()" step="0.1" type="number" value="1.2"></div>
                            <div><label class="text-[10px] font-bold text-gray-600">有机质 (g/kg)</label><input class="w-full border rounded p-1 text-xs" id="soilL3OM" oninput="calculateAll()" type="number" value="25"></div>
                            <div><label class="text-[10px] font-bold text-gray-600">水解氮 (mg/kg)</label><input class="w-full border rounded p-1 text-xs" id="soilL3N" oninput="calculateAll()" type="number" value="120"></div>
                            <div><label class="text-[10px] font-bold text-gray-600">有效磷 (mg/kg)</label><input class="w-full border rounded p-1 text-xs" id="soilL3P" oninput="calculateAll()" type="number" value="30"></div>
                            <div><label class="text-[10px] font-bold text-gray-600">速效钾 (mg/kg)</label><input class="w-full border rounded p-1 text-xs" id="soilL3K" oninput="calculateAll()" type="number" value="110"></div>
                        </div>
                        <div class="text-[10px] text-blue-600 cursor-pointer underline text-right" onclick="fillDemoLabData()">填入示范数据</div>
                    </div>
                    <div class="mt-3 bg-gray-50 p-2 rounded border border-gray-200 flex justify-between items-center" id="soil-result-bar">
                        <span class="text-xs font-bold text-gray-500">综合修正系数:</span>
                        <span class="text-xs font-mono font-bold text-green-600" id="soil-correction-display">0.85 (肥沃减量)</span>
                    </div>
                </div>
                <!-- Settings -->
                <div class="bg-white rounded-xl shadow p-4 border border-gray-200">
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 border-b pb-2">
                        <span class="material-symbols-outlined text-blue-600">settings_input_component</span> 基础参数与秸秆
                    </h3>
                    <div class="mb-4">
                        <label class="text-sm font-bold text-gray-700 block mb-1">秸秆处理 (影响N/K/微量)</label>
                        <select class="w-full border-2 border-yellow-200 rounded-lg p-2 text-sm font-bold text-gray-800 bg-yellow-50 focus:border-yellow-500 outline-none transition" id="strawSelect" onchange="calculateAll()">
                            <option value="return">🌱 秸秆还田 (需增氮 / 补钾微)</option>
                            <option value="burn">🔥 秸秆焚烧 (氮损失 / 补钾磷)</option>
                            <option value="remove">🚜 秸秆打包 (养分全失 / 贫瘠)</option>
                        </select>
                        <div class="mt-2 p-2 rounded text-xs border flex flex-col gap-1 bg-yellow-50 border-yellow-200 text-yellow-800" id="soilHealthFeedback"><div class="font-bold">⚠ 碳氮比调节：</div><div>1. 氮肥↑ (微生物消耗)。</div><div>2. 钾肥↓ (秸秆归还)。</div></div>
                    </div>
                    <div class="grid grid-cols-2 gap-3 mb-2">
                        <div>
                            <label class="text-xs font-bold text-gray-500 block mb-1">目标湿粮产量</label>
                            <input class="w-full border rounded p-2 font-bold text-gray-700" id="inputYield" oninput="calculateAll()" type="number" value="1000">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-500 block mb-1">单位</label>
                            <select class="w-full border rounded p-2 text-sm bg-gray-50 font-bold text-blue-800" id="unitSelect" onchange="calculateAll()">
                                <option value="mu">kg/亩</option>
                                <option value="ha">kg/公顷</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs font-bold text-gray-500 mb-1">
                        <span>收割含水率: <span class="text-blue-600" id="moistureDisplay">30%</span></span>
                    </div>
                    <input class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mb-2" id="inputMoisture" max="40" min="14" oninput="calculateAll()" type="range" value="30">
                    <div class="bg-blue-50 p-2 rounded border border-blue-100 flex justify-between items-center">
                        <span class="text-xs text-blue-600 block">折合标准产量 (14%水):</span>
                        <div>
                            <span class="text-xl font-bold text-blue-800" id="stdYieldDisplay">814</span> <span class="unit-label text-xs text-blue-800">kg/亩</span>
                        </div>
                    </div>
                </div>
                <!-- Fert -->
                <div class="bg-white rounded-xl shadow p-4 border border-gray-200">
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2 border-b pb-2">
                        <span class="material-symbols-outlined text-green-600">compost</span> 根部肥料配方
                    </h3>
                    <div class="space-y-4">
                        <div class="relative">
                            <label class="text-xs font-bold text-gray-500 block mb-1 flex justify-between">
                                <span>① 种肥 (Seed Fert)</span>
                                <span class="text-[10px] text-green-600 bg-green-50 px-1 rounded">5kg/亩</span>
                            </label>
                            <div class="flex gap-2">
                                <select class="flex-grow border border-gray-300 rounded p-2 text-xs bg-gray-50 truncate" id="seedFertSelect" onchange="handleFertTypeChange('seed')"><option value="-1">🚫 不施种肥</option><option value="0">26-12-10 控失保持型</option><option value="1">26-11-12 双控复合肥</option><option value="2">25-10-16 低氯复合肥</option><option value="3">25-10-13 中氯复合肥</option><option value="4">18-18-18 黄腐酸型</option><option value="5">18-18-18 双控复合肥</option><option value="6">14-16-15 硫酸钾型</option><option value="7">12-19-14 硫酸钾控失</option><option value="8">12-18-15 硫酸钾复合</option><option value="custom">🛠 自定义配方...</option></select>
                                <div class="w-20 relative">
                                    <span class="absolute left-1 top-2 text-gray-400 text-xs">¥</span>
                                    <input class="w-full border border-gray-300 rounded p-2 pl-4 text-xs" id="priceSeed" oninput="calculateAll()" placeholder="单价" type="number" value="4.2">
                                </div>
                            </div>
                            <div class="hidden mt-2 bg-yellow-50 p-2 rounded border border-yellow-200 grid grid-cols-4 gap-2 items-center" id="custom-seed-wrap">
                                <span class="text-[10px] font-bold text-yellow-800">NPK:</span>
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customSeedN" oninput="calculateAll()" type="number" value="15">
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customSeedP" oninput="calculateAll()" type="number" value="15">
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customSeedK" oninput="calculateAll()" type="number" value="15">
                            </div>
                        </div>
                        <div class="relative">
                            <label class="text-xs font-bold text-gray-500 block mb-1 flex justify-between">
                                <span>② 基肥 (Base Fert)</span>
                                <span class="text-[10px] text-blue-600 bg-blue-50 px-1 rounded">翻地深施</span>
                            </label>
                            <div class="flex gap-2">
                                <select class="flex-grow border border-gray-300 rounded p-2 text-xs bg-gray-50 truncate" id="baseFertSelect" onchange="handleFertTypeChange('base')"><option value="0">26-12-10 控失保持型</option><option value="1">26-11-12 双控复合肥</option><option value="2">25-10-16 低氯复合肥</option><option value="3">25-10-13 中氯复合肥</option><option value="4">18-18-18 黄腐酸型</option><option value="5">18-18-18 双控复合肥</option><option value="6">14-16-15 硫酸钾型</option><option value="7">12-19-14 硫酸钾控失</option><option value="8">12-18-15 硫酸钾复合</option><option value="custom">🛠 自定义配方...</option></select>
                                <div class="w-20 relative">
                                    <span class="absolute left-1 top-2 text-gray-400 text-xs">¥</span>
                                    <input class="w-full border border-gray-300 rounded p-2 pl-4 text-xs" id="priceBase" oninput="calculateAll()" placeholder="单价" type="number" value="3.8">
                                </div>
                            </div>
                            <div class="hidden mt-2 bg-yellow-50 p-2 rounded border border-yellow-200 grid grid-cols-4 gap-2 items-center" id="custom-base-wrap">
                                <span class="text-[10px] font-bold text-yellow-800">NPK:</span>
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customBaseN" oninput="calculateAll()" type="number" value="26">
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customBaseP" oninput="calculateAll()" type="number" value="12">
                                <input class="w-full border rounded p-1 npk-input text-xs" id="customBaseK" oninput="calculateAll()" type="number" value="10">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Right Panel -->
            <div class="lg:col-span-7 space-y-4">
                <div class="bg-white rounded-xl shadow p-4 border border-blue-200">
                    <h3 class="font-bold text-blue-900 mb-3 flex items-center justify-between border-b border-blue-100 pb-2">
                        <span class="flex items-center gap-2"><span class="material-symbols-outlined">vaccines</span> 叶面营养与统防统治</span>
                    </h3>
                    <div class="space-y-3">
                        <div class="flex items-start gap-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
                            <div class="pt-1"><input class="w-4 h-4 text-blue-600 rounded" id="checkV6" onchange="calculateAll()" type="checkbox"></div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <div class="font-bold text-sm text-blue-800">V6 苗期提苗套餐</div>
                                    <div class="text-xs font-bold text-blue-600 flex items-center">
                                        ¥<input class="w-12 border-b border-blue-300 text-center mx-1 bg-transparent focus:outline-none" id="inputPriceV6" oninput="calculateAll()" type="number" value="25">/<span class="unit-area-name">亩</span>
                                    </div>
                                </div>
                                <div class="text-[10px] text-blue-600 mt-1">配方: 氨基酸水溶肥 + 流体锌 + 杀虫剂</div>
                            </div>
                        </div>
                        <div class="flex items-start gap-3 p-3 bg-blue-50 rounded-lg border border-blue-100">
                            <div class="pt-1"><input class="w-4 h-4 text-blue-600 rounded" id="checkV12" onchange="calculateAll()" type="checkbox"></div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <div class="font-bold text-sm text-blue-800">V12 攻穗防虫套餐</div>
                                    <div class="text-xs font-bold text-blue-600 flex items-center">
                                        ¥<input class="w-12 border-b border-blue-300 text-center mx-1 bg-transparent focus:outline-none" id="inputPriceV12" oninput="calculateAll()" type="number" value="30">/<span class="unit-area-name">亩</span>
                                    </div>
                                </div>
                                <div class="text-[10px] text-blue-600 mt-1">配方: 尿素 + 磷酸二氢钾 + 氯虫苯甲酰胺</div>
                            </div>
                        </div>
                        <div class="flex items-start gap-3 p-3 bg-green-50 rounded-lg border border-green-200">
                            <div class="pt-1"><input checked="" class="w-4 h-4 text-green-600 rounded" id="checkVT" onchange="calculateAll()" type="checkbox"></div>
                            <div class="flex-grow">
                                <div class="flex justify-between items-center">
                                    <div class="font-bold text-sm text-green-800">VT 抽雄飞防套餐 (一喷多效)</div>
                                    <div class="text-xs font-bold text-green-600 flex items-center">
                                        ¥<input class="w-12 border-b border-green-300 text-center mx-1 bg-transparent focus:outline-none" id="inputPriceVT" oninput="calculateAll()" type="number" value="45">/<span class="unit-area-name">亩</span>
                                    </div>
                                </div>
                                <div class="text-[10px] text-green-600 mt-1">配方: 吡唑 + 苯甲 + 噻虫嗪 + 磷二 + 硼</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow p-5 border-t-4 border-yellow-500">
                    <h3 class="font-bold text-lg text-gray-800 mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-yellow-600">assignment_turned_in</span> 智能配方结果
                    </h3>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-gray-50 rounded p-2 border">
                            <div class="text-xs text-gray-500">根部种肥</div>
                            <div class="font-bold text-gray-800"><span class="text-xl" id="resSeedAmount">0.0</span> <span class="unit-label text-xs">kg/亩</span></div>
                            <div class="text-[10px] truncate text-gray-400" id="resSeedName">未施用</div>
                        </div>
                        <div class="bg-gray-50 rounded p-2 border">
                            <div class="text-xs text-gray-500">根部基肥</div>
                            <div class="font-bold text-gray-800"><span class="text-xl" id="resBaseAmount">47.7</span> <span class="unit-label text-xs">kg/亩</span></div>
                            <div class="text-[10px] truncate text-gray-400" id="resBaseName">26-12-10 控失保持型</div>
                        </div>
                    </div>
                    <div class="space-y-2 mb-4">
                        <div class="flex justify-between items-center p-2 bg-blue-50 rounded border border-blue-100">
                            <div>
                                <div class="font-bold text-sm text-blue-800">追肥 (尿素)</div>
                                <div class="text-[10px] text-blue-600 flex items-center mt-1">
                                    <span>单价 ¥</span>
                                    <input class="w-16 mx-1 border border-blue-200 rounded px-1 text-center bg-white text-blue-800 font-black focus:outline-none focus:border-blue-500 text-lg" id="priceUrea" oninput="calculateAll()" step="0.1" type="number" value="2.6">
                                    <span>/kg</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-blue-900"><span class="text-xl text-yellow-600" id="resUreaAmount">12.0</span> <span class="unit-label text-xs">kg/亩</span></div>
                                <div class="text-[10px] text-blue-400 font-bold text-yellow-600" id="ureaReason">含调节碳氮比增量</div>
                            </div>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-orange-50 rounded border border-orange-100">
                            <div>
                                <div class="font-bold text-sm text-orange-800">补钾 (氯化钾)</div>
                                <div class="text-[10px] text-orange-600 flex items-center mt-1">
                                    <span>单价 ¥</span>
                                    <input class="w-16 mx-1 border border-orange-200 rounded px-1 text-center bg-white text-orange-800 font-black focus:outline-none focus:border-orange-500 text-lg" id="priceK" oninput="calculateAll()" step="0.1" type="number" value="3.8">
                                    <span>/kg</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-orange-900"><span class="text-xl" id="resKAmount">0.0</span> <span class="unit-label text-xs">kg/亩</span></div>
                                <div class="text-[10px] text-orange-400" id="kReason">秸秆还田补充</div>
                            </div>
                        </div>
                    </div>
                    <div class="h-40 w-full relative">
                        <canvas id="fertChart" height="240" style="box-sizing: border-box; display: block; height: 160px; width: 748px;" width="1122"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow p-5 border-t-4 border-red-500">
                    <h3 class="font-bold text-lg text-gray-800 mb-3 flex items-center gap-2">
                        <span class="material-symbols-outlined text-red-600">payments</span> 成本精算表 (Costing)
                    </h3>
                    <div class="grid grid-cols-5 gap-1 mb-3 text-center text-[10px] md:text-xs">
                        <div class="bg-gray-50 p-1 rounded"><div class="text-gray-500">种肥</div><div class="font-bold">¥<span id="costSeed">0</span></div></div>
                        <div class="bg-gray-50 p-1 rounded"><div class="text-gray-500">基肥</div><div class="font-bold">¥<span id="costBase">181</span></div></div>
                        <div class="bg-gray-50 p-1 rounded"><div class="text-gray-500">追尿素</div><div class="font-bold">¥<span id="costUrea">31</span></div></div>
                        <div class="bg-gray-50 p-1 rounded"><div class="text-gray-500">补钾</div><div class="font-bold">¥<span id="costK">0</span></div></div>
                        <div class="bg-blue-50 p-1 rounded border border-blue-200"><div class="text-blue-600">叶/药</div><div class="font-bold text-blue-800">¥<span id="costFoliar">45</span></div></div>
                    </div>
                    <div class="flex items-center justify-between bg-red-50 p-4 rounded-lg border border-red-100">
                        <div>
                            <span class="block text-xs text-red-600 font-bold uppercase tracking-wider">每<span class="unit-area-name">亩</span>总成本</span>
                            <span class="text-[10px] text-red-400">含化肥、叶面肥、农药</span>
                        </div>
                        <div class="text-right">
                            <div class="text-3xl font-black text-red-700">¥<span id="totalCost">257.5</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
<footer class="bg-gray-800 text-gray-400 py-6 text-center mt-auto">
    <p class="text-sm">合记农业 · 智慧种植辅助系统 v4.5</p>
    <p class="text-[10px] mt-1 opacity-50">数据源： FAO, IPNI | 算法: 养分平衡-斯坦福方程</p>
</footer>

<script>
    let chart = null;
    let currentSoilLevel = 1;

    const fertilizers = [
        { name: "26-12-10 控失保持型", n:26, p:12, k:10 },
        { name: "26-11-12 双控复合肥", n:26, p:11, k:12 },
        { name: "25-10-16 低氯复合肥", n:25, p:10, k:16 },
        { name: "25-10-13 中氯复合肥", n:25, p:10, k:13 },
        { name: "18-18-18 黄腐酸型", n:18, p:18, k:18 },
        { name: "18-18-18 双控复合肥", n:18, p:18, k:18 },
        { name: "14-16-15 硫酸钾型", n:14, p:16, k:15 },
        { name: "12-19-14 硫酸钾控失", n:12, p:19, k:14 },
        { name: "12-18-15 硫酸钾复合", n:12, p:18, k:15 }
    ];

    const fullProtectionDB = [
        {
            id: "VE",
            group: "seedling",
            stage: "VE 出苗期 (Emergence)",
            icon: "spa",
            temp: "地温稳定 >10℃",
            water: "持水量 60-70%",
            desc: "根系建立与全苗关键期。重点防地下害虫、根腐病及杂草。低温(<10℃)或除草剂残留可致'螺旋状中胚轴'，造成出苗失败。",
            alert: "查苗补种：缺苗>10%应及时补种或移栽。板结土壤需破除。",
            recipes: [
                { name: "方案A: 常规种衣剂 (基础版)", mix: "苯醚甲环唑 + 噻虫嗪", pros: "成本低，对常见蚜虫、丝黑穗病有效。", cons: "对根腐病及顽固地下害虫持效期较短。" },
                { name: "方案B: 双效加强版 (推荐)", mix: "精甲霜灵·咯菌腈 + 高含量吡虫啉 + 锌肥", pros: "强化防根腐，促进根系发育，苗齐苗壮。", cons: "种子处理成本稍高。" },
                { name: "方案C: 封闭除草套餐 (播后苗前)", mix: "精异丙甲草胺 + 莠去津 + 乙草胺", pros: "封地效果好，早期无草害竞争。", cons: "需土壤湿度配合，干旱效果差。" }
            ]
        },
        {
            id: "V3",
            group: "seedling",
            stage: "V3-V5 苗期 (Seedling)",
            icon: "grass",
            temp: "日均 18-22℃",
            water: "适度蹲苗",
            desc: "除草最佳窗口期。生长点位于地下(V6前)，对轻微霜冻/冰雹有耐受力。如遇低温/缺磷/根系受阻，叶片可能变紫(花青素积累)。",
            alert: "除草剂药害预警：避开高温，避开3叶前5叶后。紫苗通常随气温回升消失。",
            recipes: [
                { name: "方案A: 标准除草 (安全型)", mix: "烟嘧磺隆·莠去津 + 安全剂", pros: "杀草谱广，对玉米相对安全。", cons: "对由于环境压力大的弱苗可能有轻微抑制。" },
                { name: "方案B: 苗后除草+提苗复配", mix: "烟嘧·莠 + 氨基酸水溶肥 + 芸苔素内酯", pros: "除草同时缓解药害，促进生长，叶片浓绿。", cons: "混配需注意酸碱性，成本增加。" }
            ]
        },
        {
            id: "V6",
            group: "seedling",
            stage: "V6-V8 拔节期 (Jointing)",
            icon: "nature",
            temp: "生长旺盛期",
            water: "需水增加",
            desc: "生长点出土，茎秆快速伸长。节根成为主要根系。此时若地表干旱，易发生'无根/倒伏玉米'综合征(Rootless Corn)。需肥临界期。",
            alert: "追肥提示：结合降雨或灌溉追施氮肥。若遇洪涝，淹水不可超2-4天。",
            recipes: [
                { name: "方案A: 营养补充型", mix: "尿素(叶喷) + 磷酸二氢钾 + 螯合锌", pros: "纠正缺锌花白叶，促进茎秆粗壮。", cons: "单纯营养，无防虫功能。" },
                { name: "方案B: 药肥一体防虫", mix: "氯虫苯甲酰胺 + 甲维盐 + 腐植酸叶面肥", pros: "强力杀灭二代粘虫、玉米螟，持效期长。", cons: "氯虫苯甲酰胺单价较高。" },
                { name: "方案C: 化学控旺 (防倒伏专用)", mix: "乙烯利 / 胺鲜·乙烯利 (6-10叶期)", pros: "降低株高，增粗茎秆，显著抗倒伏。", cons: "需严格把控浓度与时期，干旱禁用。" }
            ]
        },
        {
            id: "V12",
            group: "ear",
            stage: "V9-V12 大喇叭口 (Bell Mouth)",
            icon: "local_florist",
            temp: "高温高湿",
            water: "需水高峰",
            desc: "V9雄穗发育。V12时，种子行数已确定(受遗传主导)。每行粒数开始决定(V12-V17)。此期受旱或叶片损伤将严重影响穗大小。",
            alert: "关键节点：行数已定，主攻粒数。此期受旱减产最严重。",
            recipes: [
                { name: "方案A: 攻穗防虫型", mix: "辛硫磷颗粒(丢心) + 尿素(根施)", pros: "传统方法，成本极低，效果直接。", cons: "人工成本高，效率低。" },
                { name: "方案B: 飞防高效包", mix: "甲维·茚虫威 + 吡唑醚菌酯 + 磷酸二氢钾", pros: "杀虫彻底，防大斑病，叶片保绿。", cons: "需无人机作业。" }
            ]
        },
        {
            id: "VT",
            group: "ear",
            stage: "VT-R1 抽雄吐丝 (Tasseling)",
            icon: "filter_vintage",
            temp: "忌>30-35℃高温",
            water: "必须充足",
            desc: "授粉期。花粉散落高峰在上午9-10点。高温(>30℃)减少散粉。干旱每天减产3-8%。冰雹致叶片脱落可致100%减产。",
            alert: "热害预警：防花丝'结球'。虫害阈值：花丝被咬断至<1cm且授粉<50%需防治。",
            recipes: [
                { name: "方案A: 授粉保卫战", mix: "流体硼 + 芸苔素内酯 + 磷酸二氢钾", pros: "提高花粉活力，减少秃尖，抗热干风。", cons: "无杀菌杀虫功能。" },
                { name: "方案B: 一喷多效旗舰版", mix: "吡唑醚菌酯 + 噻虫嗪 + 苯甲·丙环唑 + 硼 + 磷二", pros: "防病(锈病/斑病)、防虫(蚜虫)、增产全覆盖。", cons: "单亩成本最高，但投入产出比高。" }
            ]
        },
        {
            id: "R2",
            group: "grain",
            stage: "R2-R4 灌浆乳熟 (Filling)",
            icon: "grain",
            temp: "昼夜温差大好",
            water: "保持湿润",
            desc: "籽粒建成期。水泡期(R2)至乳熟期(R3)。若遇连续阴天、干旱 or 氮不足，尖端籽粒易败育(Abortion)。",
            alert: "适时晚收：苞叶变黄后推迟7-10天收获，增产5-10%。",
            recipes: [
                { name: "方案A: 防衰增重", mix: "高浓度磷酸二氢钾 (100-200g/亩)", pros: "促进灌浆，增加千粒重，防止倒伏。", cons: "功能单一。" },
                { name: "方案B: 杀菌防病晚收", mix: "戊唑醇/氟环唑 + 磷酸二氢钾", pros: "特效治疗南方锈病，保叶功能强。", cons: "后期作业需高杆喷雾机 or 飞机。" }
            ]
        }
    ];

    window.onload = function() {
        renderFullProtection('all');
        renderFertOptions();
        updatePlantingCalc();
        calculateAll();
    };

    function renderFullProtection(filter) {
        const list = document.getElementById('protection-list');
        list.innerHTML = '';
        const filtered = filter === 'all' ? fullProtectionDB : fullProtectionDB.filter(i => i.group === filter);

        filtered.forEach((item) => {
            const optionsHtml = item.recipes.map((r, rIdx) => `<option value="${rIdx}">${r.name}</option>`).join('');
            const card = document.createElement('div');
            card.className = "bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition duration-300";
            card.innerHTML = `
                <div class="p-4 border-b border-gray-200 bg-white flex flex-col md:flex-row justify-between items-start md:items-center gap-3">
                    <div class="flex items-center gap-3">
                        <div class="bg-green-100 p-2 rounded-full text-green-700">
                            <span class="material-symbols-outlined">${item.icon}</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800 text-lg">${item.stage}</h4>
                            <div class="flex gap-2 text-[10px] mt-1">
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">thermostat</span> ${item.temp}
                                </span>
                                <span class="bg-blue-50 text-blue-600 px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1">
                                    <span class="material-symbols-outlined text-[10px]">water_drop</span> ${item.water}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="w-full md:w-auto">
                        <span class="text-xs font-bold text-red-500 bg-red-50 px-2 py-1 rounded border border-red-100 block md:inline text-center">
                            ⚠️ ${item.alert}
                        </span>
                    </div>
                </div>
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-2">
                        <p class="text-sm text-gray-600 leading-relaxed">${item.desc}</p>
                        <div class="mt-4">
                            <label class="text-xs font-bold text-gray-500 block mb-1">选择植保方案:</label>
                            <select class="w-full border-2 border-green-200 rounded p-2 text-sm font-bold text-green-800 bg-white focus:border-green-500 outline-none transition" 
                                    onchange="updateRecipeDetails('${item.id}', this.value)">
                                ${optionsHtml}
                            </select>
                        </div>
                    </div>
                    <div class="bg-white rounded border border-gray-200 p-3 shadow-inner" id="details-${item.id}"></div>
                </div>
            `;
            list.appendChild(card);
            updateRecipeDetails(item.id, 0);
        });
    }

    function updateRecipeDetails(itemId, recipeIdx) {
        const item = fullProtectionDB.find(i => i.id === itemId);
        const recipe = item.recipes[recipeIdx];
        const el = document.getElementById(`details-${itemId}`);
        if(!recipe) return;
        el.innerHTML = `
            <div class="h-full flex flex-col justify-center space-y-2">
                <div class="border-b pb-2 mb-1">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">配方成分</span>
                    <div class="text-sm font-bold text-green-700 break-words">${recipe.mix}</div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div>
                        <span class="text-green-600 font-bold block">👍 优点</span>
                        <span class="text-gray-500">${recipe.pros}</span>
                    </div>
                    <div>
                        <span class="text-red-500 font-bold block">👎 缺点/注意</span>
                        <span class="text-gray-500">${recipe.cons}</span>
                    </div>
                </div>
            </div>
        `;
    }

    function filterProtection(val) { renderFullProtection(val); }

    function calculateAll() {
        const unit = document.getElementById('unitSelect').value;
        const areaFactor = unit === 'ha' ? 15 : 1;
        const areaName = unit === 'ha' ? '公顷' : '亩';
        document.querySelectorAll('.unit-label').forEach(e => e.textContent = `kg/${areaName}`);
        document.querySelectorAll('.unit-area-name').forEach(e => e.textContent = areaName);

        const rawYield = parseFloat(document.getElementById('inputYield').value) || 0;
        const moisture = parseFloat(document.getElementById('inputMoisture').value);
        document.getElementById('moistureDisplay').textContent = moisture + "%";
        const stdYield = rawYield * (1 - moisture/100) / 0.86;
        document.getElementById('stdYieldDisplay').textContent = stdYield.toFixed(0);

        const soilCF = getSoilCorrection();
        const meanCF = ((soilCF.n + soilCF.p + soilCF.k)/3).toFixed(2);
        const soilBadge = document.getElementById('soil-correction-display');
        if (meanCF < 1) {
            soilBadge.className = "text-xs font-mono font-bold text-green-600";
            soilBadge.textContent = `${meanCF} (肥沃减量)`;
        } else if (meanCF > 1) {
            soilBadge.className = "text-xs font-mono font-bold text-red-600";
            soilBadge.textContent = `${meanCF} (贫瘠增量)`;
        } else {
            soilBadge.className = "text-xs font-mono font-bold text-blue-600";
            soilBadge.textContent = "1.0 (标准用量)";
        }

        const strawType = document.getElementById('strawSelect').value;
        const feedbackEl = document.getElementById('soilHealthFeedback');
        let reqN = (stdYield / 100) * 2.3 * soilCF.n;
        let reqP = (stdYield / 100) * 0.9 * soilCF.p;
        let reqK = (stdYield / 100) * 2.3 * soilCF.k;
        let supplyK_Straw = 0;
        let ureaReasonText = "大喇叭口期追施";
        let kReasonText = "土壤亏缺补充";

        if (strawType === 'return') {
            reqN += 2.0 * areaFactor; 
            reqP = Math.max(0, reqP - 0.5 * areaFactor);
            supplyK_Straw = reqK * 0.80;
            feedbackEl.className = "mt-2 p-2 rounded text-xs border flex flex-col gap-1 bg-yellow-50 border-yellow-200 text-yellow-800";
            feedbackEl.innerHTML = `<div class="font-bold">⚠ 碳氮比调节：</div><div>1. 氮肥↑ (微生物消耗)。</div><div>2. 钾肥↓ (秸秆归还)。</div>`;
            ureaReasonText = "含调节碳氮比增量";
            kReasonText = "秸秆还田补充";
        } else if (strawType === 'burn') {
            supplyK_Straw = reqK * 0.65;
            reqP = Math.max(0, reqP - 0.5 * areaFactor);
            feedbackEl.className = "mt-2 p-2 rounded text-xs border flex flex-col gap-1 bg-orange-50 border-orange-200 text-orange-800";
            feedbackEl.innerHTML = `<div class="font-bold">🔥 焚烧模式：</div><div>氮损失，磷钾利用率低。</div>`;
        } else {
            supplyK_Straw = reqK * 0.05; 
            feedbackEl.className = "mt-2 p-2 rounded text-xs border flex flex-col gap-1 bg-red-50 border-red-200 text-red-800";
            feedbackEl.innerHTML = `<div class="font-bold">❗ 秸秆移出：</div><div>养分透支，需足量补充。</div>`;
            kReasonText = "严重亏缺";
        }

        const targetK = Math.max(0, reqK - supplyK_Straw);
        const seedVal = document.getElementById('seedFertSelect').value;
        let seedData = getFertData(seedVal, 'seed');
        let seedAmt = seedVal === '-1' ? 0 : 5 * areaFactor;
        const baseVal = document.getElementById('baseFertSelect').value;
        let baseData = getFertData(baseVal, 'base');
        let baseAmt = (Math.max(0, reqP - (seedAmt * seedData.p/100))) / (baseData.p / 100 || 1);
        const supN = (seedAmt * seedData.n/100) + (baseAmt * baseData.n/100);
        const ureaAmt = Math.max(0, reqN - supN) / 0.46;
        const kGap = Math.max(0, targetK - ((seedAmt * seedData.k/100) + (baseAmt * baseData.k/100)));
        let kAddAmt = kGap > (2 * areaFactor) ? kGap / 0.6 : 0;

        const pSeed = parseFloat(document.getElementById('priceSeed').value)||0;
        const pBase = parseFloat(document.getElementById('priceBase').value)||0;
        const pUrea = parseFloat(document.getElementById('priceUrea').value)||0;
        const pK = parseFloat(document.getElementById('priceK').value)||0;
        let cFoliar = 0;
        if(document.getElementById('checkV6').checked) cFoliar += parseFloat(document.getElementById('inputPriceV6').value)||0;
        if(document.getElementById('checkV12').checked) cFoliar += parseFloat(document.getElementById('inputPriceV12').value)||0;
        if(document.getElementById('checkVT').checked) cFoliar += parseFloat(document.getElementById('inputPriceVT').value)||0;
        
        document.getElementById('resSeedAmount').innerText = seedAmt.toFixed(1);
        document.getElementById('resBaseAmount').innerText = baseAmt.toFixed(1);
        document.getElementById('resUreaAmount').innerText = ureaAmt.toFixed(1);
        document.getElementById('ureaReason').innerText = ureaReasonText;
        document.getElementById('resKAmount').innerText = kAddAmt.toFixed(1);
        document.getElementById('kReason').innerText = kReasonText;
        document.getElementById('costSeed').innerText = (seedAmt * pSeed).toFixed(0);
        document.getElementById('costBase').innerText = (baseAmt * pBase).toFixed(0);
        document.getElementById('costUrea').innerText = (ureaAmt * pUrea).toFixed(0);
        document.getElementById('costK').innerText = (kAddAmt * pK).toFixed(0);
        document.getElementById('costFoliar').innerText = cFoliar.toFixed(0);
        document.getElementById('totalCost').innerText = (seedAmt*pSeed+baseAmt*pBase+ureaAmt*pUrea+kAddAmt*pK+cFoliar).toFixed(1);

        updateChart(reqN, reqP, reqK, supN, (seedAmt * seedData.p/100) + (baseAmt * baseData.p/100), (seedAmt * seedData.k/100) + (baseAmt * baseData.k/100), ureaAmt*0.46, kAddAmt*0.6, areaName, supplyK_Straw);
    }

    function renderFertOptions() {
        const seed = document.getElementById('seedFertSelect');
        const base = document.getElementById('baseFertSelect');
        seed.innerHTML = '<option value="-1">🚫 不施种肥</option>';
        base.innerHTML = '';
        fertilizers.forEach((f, i) => {
            const opt = new Option(`${f.name}`, i);
            seed.add(opt.cloneNode(true));
            base.add(opt.cloneNode(true));
        });
        const custom = new Option("🛠 自定义配方...", "custom");
        seed.add(custom.cloneNode(true));
        base.add(custom.cloneNode(true));
        base.selectedIndex = 0;
    }

    function getSoilCorrection() {
        let factor = { n: 1.0, p: 1.0, k: 1.0 };
        if (currentSoilLevel === 1) {
            const type = document.getElementById('soilL1Type').value;
            const yieldLvl = document.querySelector('input[name="soilL1Yield"]:checked').value;
            let avg = 1.0 + (type === 'high' ? -0.15 : (type === 'low' ? 0.15 : 0)) + (yieldLvl === 'high' ? -0.05 : (yieldLvl === 'low' ? 0.1 : 0));
            factor = { n: avg, p: avg, k: avg };
        } else if (currentSoilLevel === 3) {
            const vN = parseFloat(document.getElementById('soilL3N').value);
            const vP = parseFloat(document.getElementById('soilL3P').value);
            const vK = parseFloat(document.getElementById('soilL3K').value);
            factor.n = vN > 150 ? 0.8 : (vN < 90 ? 1.2 : 1.0);
            factor.p = vP > 40 ? 0.8 : (vP < 15 ? 1.2 : 1.0);
            factor.k = vK > 130 ? 0.8 : (vK < 80 ? 1.2 : 1.0);
        }
        return factor;
    }

    function getFertData(val, type) {
        if(val==='-1') return {name:"未施用", n:0, p:0, k:0};
        if(val==='custom') {
            const prefix = type === 'seed' ? 'customSeed' : 'customBase';
            return { n: parseFloat(document.getElementById(prefix+'N').value)||0, p: parseFloat(document.getElementById(prefix+'P').value)||0, k: parseFloat(document.getElementById(prefix+'K').value)||0, name: "自定义" };
        }
        return fertilizers[val];
    }

    function handleFertTypeChange(type) {
        const val = document.getElementById(type+'FertSelect').value;
        document.getElementById('custom-'+type+'-wrap').classList.toggle('hidden', val !== 'custom');
        calculateAll();
    }

    function switchSoilLevel(level) {
        currentSoilLevel = level;
        [1,3].forEach(l => {
            document.getElementById(`btn-soil-l${l}`).classList.toggle('active', l === level);
            document.getElementById(`soil-level-${l}`).classList.toggle('hidden', l !== level);
        });
        calculateAll();
    }

    function fillDemoLabData() {
        document.getElementById('soilL3PH').value = 6.8;
        document.getElementById('soilL3TN').value = 1.8;
        document.getElementById('soilL3OM').value = 35;
        document.getElementById('soilL3N').value = 150;
        document.getElementById('soilL3P').value = 45;
        document.getElementById('soilL3K').value = 140;
        calculateAll();
    }

    function updateChart(reqN, reqP, reqK, supN, supP, supK, supUrea, supAddK, areaName, strawK) {
        const ctx = document.getElementById('fertChart').getContext('2d');
        if(chart) chart.destroy();
        chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['纯氮(N)', '纯磷(P)', '纯钾(K)'],
                datasets: [
                    { label: '总需求', data: [reqN, reqP, reqK], type: 'line', borderColor: '#9ca3af', borderWidth: 2, borderDash: [5,5], pointStyle: 'crossRot' },
                    { label: '秸秆归还', data: [0, 0, strawK], backgroundColor: '#fbbf24', stack: 'supply' },
                    { label: '基/种肥', data: [supN, supP, supK], backgroundColor: '#16a34a', stack: 'supply' },
                    { label: '追肥/补钾', data: [supUrea, 0, supAddK], backgroundColor: '#3b82f6', stack: 'supply' }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } }, plugins: { legend: { position: 'bottom' } } }
        });
    }

    function updatePlantingCalc() {
        const space = parseFloat(document.getElementById('ridgeSpace').value)||60;
        const dens = parseFloat(document.getElementById('targetDensity').value)||4500;
        if(space>0 && dens>0) { document.getElementById('plantSpaceResult').innerText = (6666667/(space*dens)).toFixed(1); }
        const ridgeType = document.querySelector('input[name="ridgeType"]:checked').value;
        const hintEl = document.getElementById('ridgeHint');
        hintEl.innerText = ridgeType === 'normal' ? '输入垄距' : '输入平均垄距';
    }

    function switchTab(id) {
        ['planting','protection','fertilizer'].forEach(t => {
            document.getElementById('view-'+t).classList.toggle('hidden', t !== id);
            document.getElementById('tab-'+t).classList.replace(t === id ? 'tab-inactive' : 'tab-active', t === id ? 'tab-active' : 'tab-inactive');
        });
    }

    function downloadApp() {
        const blob = new Blob([document.documentElement.outerHTML], {type:'text/html'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "合记农业_Pro_v4.5.html";
        a.click();
    }
</script>


</body></html>
